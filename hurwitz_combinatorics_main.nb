(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67197,       1664]
NotebookOptionsPosition[     61984,       1574]
NotebookOutlinePosition[     62417,       1591]
CellTagsIndexPosition[     62374,       1588]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:041d\:0435\:0441\:0432\:044f\:0437\:043d\:044b\:0435 \:043f\:0440\
\:043e\:0441\:0442\:044b\:0435 \:043e\:0434\:043d\:043e\:0442\:043e\:0447\
\:0435\:0447\:043d\:044b\:0435 \:0427\:0413 \:043f\:043e \:043e\:043f\:0440\
\:0435\:0434\:0435\:043b\:0435\:043d\:0438\:044e", "Section",
 CellChangeTimes->{{3.8553056045477343`*^9, 
  3.855305632113017*^9}},ExpressionUUID->"9dc9926a-e6d7-4447-9419-\
42ffdee9be8e"],

Cell[TextData[{
 "\:041f\:0440\:043e\:0441\:0442\:044b\:0435 \:043e\:0434\:043d\:043e\:0442\
\:043e\:0447\:0435\:0447\:043d\:044b\:0435 \:0447\:0438\:0441\:043b\:0430 \
\:0413\:0443\:0440\:0432\:0438\:0446\:0430 \:0431\:0440\:0443\:0442\:0444\
\:043e\:0440\:0441\:043e\:043c \:043f\:043e \:043e\:043f\:0440\:0435\:0434\
\:0435\:043b\:0435\:043d\:0438\:044e:\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["h", "TI"], 
          RowBox[{
            StyleBox["m", "TI"], ",", "\[Mu]"}], "\[EmptySmallCircle]"], 
         "\[LongEqual]", 
         FractionBox["1", 
          RowBox[{
            StyleBox["n", "TI"], "!"}]], "|", 
         RowBox[{"{", 
           RowBox[{
             RowBox[{"(", 
               RowBox[{
                 SubscriptBox["\[Tau]", "1"], ",", "\[Ellipsis]", 
                 SubscriptBox["\[Tau]", 
                  StyleBox["m", "TI"]]}], ")"}], "\[Element]", 
             SubsuperscriptBox[
              StyleBox["C", "TI"], "2", 
              StyleBox["n", "TI"]], "|", 
             SubscriptBox["\[Tau]", 
              StyleBox["m", "TI"]], "\[EmptySmallCircle]", "\[Ellipsis]", 
             SubscriptBox["\[Tau]", "1"], "\[Element]", 
             SubscriptBox[
              StyleBox["C", "TI"], "\[Mu]"]}], "}"}], "|"}], TraditionalForm],
      "errors" -> {}, "input" -> 
     "h^\\circ_{m, \\mu}=\\frac{1}{n!}|\\{(\\tau_1,\\dots\\tau_m)\\in \
C_2^n\\mid \\tau_m\\circ \\dots\\tau_1 \\in C_\\mu\\}|", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "a288700d-dc93-4445-b539-f6d97c46c4df"],
 "\n"
}], "Text",
 CellChangeTimes->{
  3.8577106632957706`*^9},ExpressionUUID->"8c5959f8-1fd2-4514-b9d4-\
7a125a0260e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IsSameCycleType", "[", 
   RowBox[{"perm1_", ",", "perm2_"}], "]"}], ":=", 
  RowBox[{"Equal", "[", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Tally", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", 
        RowBox[{"perm1", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"Sort", "[", 
     RowBox[{"Tally", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", 
        RowBox[{"perm2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HasCycleType", "[", 
   RowBox[{"perm_", ",", "part_"}], "]"}], ":=", 
  RowBox[{"Equal", "[", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Tally", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", 
        RowBox[{"perm", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"Sort", "[", 
     RowBox[{"Tally", "[", 
      RowBox[{"Select", "[", 
       RowBox[{"part", ",", 
        RowBox[{
         RowBox[{"#", "!=", "1"}], "&"}]}], "]"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hSimpleBruteforce", "[", 
   RowBox[{"m_", ",", "part_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"PermutationProduct", "@@@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"Cycles", "[", 
          RowBox[{"{", "#", "}"}], "]"}], "]"}], ",", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Subsets", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Plus", "@@", "part"}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "m"}], "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Generating", " ", "all", " ", "m"}], "-", 
        RowBox[{
        "tuples", " ", "of", " ", "transpositions", " ", "from", " ", 
         "S_n"}]}], ",", " ", 
       RowBox[{"n", "=", 
        RowBox[{"|", "partition", "|"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"perm_", "/;", 
      RowBox[{"HasCycleType", "[", 
       RowBox[{"perm", ",", " ", "part"}], "]"}]}]}], "]"}], "/", 
   RowBox[{"Factorial", "[", 
    RowBox[{"Plus", "@@", "part"}], "]"}], " "}]}]}], "Input",
 CellChangeTimes->{{3.855301838521247*^9, 3.8553018431661625`*^9}, {
  3.8553022514149*^9, 3.855302298413021*^9}, {3.855302423345422*^9, 
  3.8553024266110153`*^9}, {3.85530487424802*^9, 3.8553049219755583`*^9}, {
  3.8553051332328186`*^9, 3.855305149118018*^9}, {3.8553056640436316`*^9, 
  3.855305664429234*^9}, {3.855911360254729*^9, 3.8559113612855363`*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"7680901e-88af-40dd-9776-8240f9816857"]
}, Closed]],

Cell[CellGroupData[{

Cell["\:0421\:0432\:044f\:0437\:043d\:044b\:0435 \:043f\:0440\:043e\:0441\
\:0442\:044b\:0435 \:043e\:0434\:043d\:043e\:0442\:043e\:0447\:0435\:0447\
\:043d\:044b\:0435 \:0427\:0413 \:043f\:043e \:043e\:043f\:0440\:0435\:0434\
\:0435\:043b\:0435\:043d\:0438\:044e", "Section",
 CellChangeTimes->{{3.855305678451025*^9, 
  3.8553056925250173`*^9}},ExpressionUUID->"6727e29a-26e0-4a75-b256-\
fa682a075242"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IsTranspositionTupleTransitive", "[", "tuple_", "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Length", "[", 
     RowBox[{"GroupOrbits", "[", 
      RowBox[{"PermutationGroup", "[", "tuple", "]"}], "]"}], "]"}], "==", 
    "1"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hSimpleConnectedBruteforce", "[", 
   RowBox[{"m_", ",", "part_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Count", "[", 
    RowBox[{
     RowBox[{"PermutationProduct", "@@@", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{"Function", "[", 
         RowBox[{"Cycles", "[", 
          RowBox[{"{", "#", "}"}], "]"}], "]"}], ",", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"Subsets", "[", 
           RowBox[{
            RowBox[{"Range", "[", 
             RowBox[{"Plus", "@@", "part"}], "]"}], ",", 
            RowBox[{"{", "2", "}"}]}], "]"}], ",", "m"}], "]"}], ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ",", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Generating", " ", "all", " ", "m"}], "-", 
        RowBox[{
        "tuples", " ", "of", " ", "transpositions", " ", "from", " ", 
         "S_n"}]}], ",", " ", 
       RowBox[{"n", "=", 
        RowBox[{"|", "partition", "|"}]}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"perm_", "/;", 
      RowBox[{"HasCycleType", "[", 
       RowBox[{"perm", ",", " ", "part"}], "]"}]}]}], "]"}], "/", 
   RowBox[{"Factorial", "[", 
    RowBox[{"Plus", "@@", "part"}], "]"}], " "}]}]}], "Input",
 CellChangeTimes->{{3.8548203886518607`*^9, 3.854820465796357*^9}, {
  3.8548205043496623`*^9, 3.8548205078168616`*^9}, {3.855305911068093*^9, 
  3.8553059728979197`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"e57ec284-b2d9-4ac4-aaa0-8d024b0f6ac0"]
}, Closed]],

Cell[CellGroupData[{

Cell["\:0427\:0435\:0440\:0435\:0437 \:0443\:0440\:0430\:0432\:043d\:0435\
\:043d\:0438\:0435 \:0442\:0440\:0430\:043d\:0441\:043f\:043e\:0437\:0438\
\:0446\:0438\:0438", "Section",
 CellChangeTimes->{{3.8553058502232623`*^9, 
  3.855305858133018*^9}},ExpressionUUID->"e93786fc-0543-4e1b-beee-\
d044fc1204f1"],

Cell[TextData[{
 "\:041e\:0431\:043e\:0437\:043d\:0430\:0447\:0438\:043c ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         RowBox[{"(", 
           StyleBox["n", "TI"], ")"}], "\[LongEqual]", 
         UnderscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["i", "TI"], "+", 
            StyleBox["j", "TI"], "\[LongEqual]", 
            StyleBox["n", "TI"]}], LimitsPositioning -> True], 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox[
              StyleBox["A", "TI"], "1"], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["i", "TI"], ",", 
                 StyleBox["j", "TI"]}], ")"}], "+", 
             SubscriptBox[
              StyleBox["A", "TI"], "2"], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["i", "TI"], ",", 
                 StyleBox["j", "TI"]}], ")"}]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "A(n)=\\sum_{i+j=n} \\left( A_1(i, j) + A_2(i, j) \\right)", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "055bcdbf-bc81-4f8f-bd00-caeaf6a30683"],
 ", \:0433\:0434\:0435 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["A", "TI"], "1"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], ",", 
             StyleBox["j", "TI"]}], ")"}], "\[LongEqual]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], "+", 
             StyleBox["j", "TI"]}], ")"}], 
         SubscriptBox[
          StyleBox["p", "TI"], 
          StyleBox["i", "TI"]], 
         SubscriptBox[
          StyleBox["p", "TI"], 
          StyleBox["j", "TI"]], 
         FractionBox["\[PartialD]", 
          RowBox[{"\[PartialD]", 
            SubscriptBox[
             StyleBox["p", "TI"], 
             RowBox[{
               StyleBox["i", "TI"], "+", 
               StyleBox["j", "TI"]}]]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "A_1(i, j) = (i + j)p_i p_j \\frac{\\partial}{\\partial p_{i + j}}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "6e88ad53-a414-4f5f-96e4-c3f1fef6781a"],
 " \:0438 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["A", "TI"], "2"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], ",", 
             StyleBox["j", "TI"]}], ")"}], "\[LongEqual]", 
         StyleBox["i", "TI"], 
         StyleBox["j", "TI"], 
         SubscriptBox[
          StyleBox["p", "TI"], 
          RowBox[{
            StyleBox["i", "TI"], "+", 
            StyleBox["j", "TI"]}]], 
         FractionBox[
          SuperscriptBox["\[PartialD]", "2"], 
          RowBox[{"\[PartialD]", 
            SubscriptBox[
             StyleBox["p", "TI"], 
             StyleBox["i", "TI"]], "\[PartialD]", 
            SubscriptBox[
             StyleBox["p", "TI"], 
             StyleBox["j", "TI"]]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "A_2(i, j) = ijp_{i + j}\\frac{\\partial^2}{\\partial p_i \\partial \
p_j}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2ef7748b-072d-4aac-9ec6-63a6d53dba32"],
 ". \:041e\:043f\:0435\:0440\:0430\:0442\:043e\:0440 \:0442\:0440\:0430\:043d\
\:0441\:043f\:043e\:0437\:0438\:0446\:0438\:0438: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], "\[LongEqual]", 
         UnderoverscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["n", "TI"], "\[LongEqual]", "1"}], "\[Infinity]", 
          LimitsPositioning -> True], 
         StyleBox["A", "TI"], 
         RowBox[{"(", 
           StyleBox["n", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "A=\\sum_{n=1}^{\\infty} A(n)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "3642412d-3572-47c5-a6fa-ed8b80873062"]
}], "Text",
 CellChangeTimes->{{3.8548245295653477`*^9, 3.8548245330264883`*^9}, {
  3.8548259566192636`*^9, 
  3.854825982416321*^9}},ExpressionUUID->"24a36f4d-8076-46db-a902-\
a411b8ebebfa"],

Cell[CellGroupData[{

Cell["\:041f\:0440\:043e\:0441\:0442\:044b\:0435 \:043e\:0434\:043d\:043e\
\:0442\:043e\:0447\:0435\:0447\:043d\:044b\:0435 \:0447\:0438\:0441\:043b\
\:0430 \:0413\:0443\:0440\:0432\:0438\:0446\:0430", "Subsection",
 CellChangeTimes->{{3.8557958508196077`*^9, 
  3.8557958770023623`*^9}},ExpressionUUID->"707b6586-042b-451b-99f2-\
ce36fad10d27"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"upTo", ":=", "20"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hSimpleTransposition", "[", 
   RowBox[{"m_", ",", "part_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"upTo", "=", "15"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", "H", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"A1", "[", 
      RowBox[{"nests_", ",", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", " ", "+", " ", "j"}], ")"}], 
      RowBox[{"p", "[", "i", "]"}], 
      RowBox[{"p", "[", "j", "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"H", "[", "nests", "]"}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"i", "+", "j"}], "]"}]}], "]"}]}]}], ";", "        ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"A2", "[", 
      RowBox[{"nests_", ",", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"i", " ", "j", " ", 
      RowBox[{"p", "[", 
       RowBox[{"i", "+", "j"}], "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"H", "[", "nests", "]"}], ",", 
          RowBox[{"p", "[", "i", "]"}]}], "]"}], ",", 
        RowBox[{"p", "[", "j", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Asum", "[", 
      RowBox[{"nests_", ",", "A_", ",", "n_Integer"}], "]"}], ":=", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"nests", ",", "pair"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"pair", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"n", "-", "x"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
       ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"An", "[", 
      RowBox[{"n_Integer", ",", "nests_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Asum", "[", 
         RowBox[{"nests", ",", "A1", ",", "n"}], "]"}], "+", 
        RowBox[{"Asum", "[", 
         RowBox[{"nests", ",", "A2", ",", "n"}], "]"}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"A", "[", "nests_", "]"}], ":=", 
     RowBox[{"Expand", "[", 
      RowBox[{"Plus", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"An", "[", 
          RowBox[{"x", ",", "nests"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "1", ",", "upTo"}], "}"}]}], "]"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"H", "[", "nests_Integer", "]"}], ":=", 
     RowBox[{
      RowBox[{"H", "[", "nests", "]"}], "=", 
      RowBox[{"A", "[", " ", 
       RowBox[{"nests", "-", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"H", "[", "0", "]"}], "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"E", "^", 
         RowBox[{"p", "[", "1", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"p", "[", "1", "]"}], ",", "0", ",", "upTo"}], "}"}]}], 
       "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FreeCoefficient", "[", "c_", "]"}], ":=", 
     RowBox[{"c", "/.", 
      RowBox[{
       RowBox[{"p", "[", "_", "]"}], "->", "0"}]}]}], ";", 
    RowBox[{"FreeCoefficient", "[", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"H", "[", "m", "]"}], ",", 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{"Map", "[", 
          RowBox[{"p", ",", "part"}], "]"}], ")"}]}]}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", ")"}]}]}], "Input",
 CellChangeTimes->{{3.8557958978826156`*^9, 3.855795945803814*^9}, {
   3.8557961449106617`*^9, 3.855796144955364*^9}, 3.85579642921358*^9, {
   3.8557965237883463`*^9, 3.855796526155608*^9}, {3.855796593610606*^9, 
   3.855796616322667*^9}, {3.855796930762607*^9, 3.85579693160213*^9}, {
   3.8557969656220217`*^9, 3.855796966742363*^9}, {3.855797319129358*^9, 
   3.8557973194566393`*^9}, {3.8557993440771556`*^9, 
   3.8557993520687947`*^9}, {3.8557994705079775`*^9, 
   3.8557994787960434`*^9}, {3.85579962559597*^9, 3.8557996524275*^9}, {
   3.855799937387602*^9, 3.85579993810835*^9}, {3.8558001961705403`*^9, 
   3.855800214698968*^9}, {3.8568299179140344`*^9, 3.856829942466648*^9}, {
   3.8568387437828083`*^9, 3.8568387795119705`*^9}, {3.8568390733950367`*^9, 
   3.8568390849207387`*^9}, {3.8568391803151155`*^9, 
   3.8568391822906065`*^9}, {3.8568392240322638`*^9, 
   3.8568392320505495`*^9}, {3.856839283330002*^9, 3.8568393126242046`*^9}, {
   3.8568393851895485`*^9, 3.8568394424234304`*^9}, {3.856839508945165*^9, 
   3.856839510906248*^9}, {3.856839619984626*^9, 3.856839621338928*^9}, {
   3.8568396993489075`*^9, 3.8568397226768756`*^9}, {3.8568397589744864`*^9, 
   3.856839794850649*^9}, {3.8568406473921485`*^9, 3.8568407047100024`*^9}, {
   3.85684074633397*^9, 3.856840747625004*^9}, {3.8568410525933733`*^9, 
   3.8568410649910955`*^9}, {3.856841213336339*^9, 3.856841314353243*^9}, {
   3.85684135316619*^9, 3.856841361423025*^9}, {3.856841680425644*^9, 
   3.856841690147092*^9}, {3.8568417269395633`*^9, 3.8568417619938483`*^9}, {
   3.8568417925555735`*^9, 3.856841796693766*^9}, {3.856841980382755*^9, 
   3.856841988283491*^9}, {3.856842096506627*^9, 3.856842131269628*^9}, 
   3.857023735372448*^9, {3.8576246082091036`*^9, 3.857624615165003*^9}, {
   3.8576257830347595`*^9, 3.8576257881435127`*^9}, {3.857627256362034*^9, 
   3.857627257584239*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"b32d5504-6d81-4e05-9dd6-642b48f7c72a"]
}, Closed]],

Cell[CellGroupData[{

Cell["\:0421\:0432\:044f\:0437\:043d\:044b\:0435 \:043e\:0434\:043d\:043e\
\:0442\:043e\:0447\:0435\:0447\:043d\:044b\:0435 \:0447\:0438\:0441\:043b\
\:0430 \:0413\:0443\:0440\:0432\:0438\:0446\:0430", "Subsection",
 CellChangeTimes->{{3.8558085491833615`*^9, 3.855808560590413*^9}, {
  3.8568310125755234`*^9, 
  3.856831026052518*^9}},ExpressionUUID->"26379ea7-1e84-4a72-a507-\
0326df8f1866"],

Cell[TextData[{
 "\:041e\:0431\:043e\:0437\:043d\:0430\:0447\:0438\:043c ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], 
         RowBox[{"(", 
           StyleBox["n", "TI"], ")"}], "\[LongEqual]", 
         UnderscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["i", "TI"], "+", 
            StyleBox["j", "TI"], "\[LongEqual]", 
            StyleBox["n", "TI"]}], LimitsPositioning -> True], 
         RowBox[{"(", 
           RowBox[{
             SubscriptBox[
              StyleBox["A", "TI"], "1"], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["i", "TI"], ",", 
                 StyleBox["j", "TI"]}], ")"}], "+", 
             SubscriptBox[
              StyleBox["A", "TI"], "2"], 
             RowBox[{"(", 
               RowBox[{
                 StyleBox["i", "TI"], ",", 
                 StyleBox["j", "TI"]}], ")"}], "+", 
             SubscriptBox[
              StyleBox["A", "TI"], "3"]}], ")"}]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "A(n)=\\sum_{i+j=n} \\left( A_1(i, j) + A_2(i, j)+A_3\\right)", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "8f682148-9268-43ce-b840-4811f4b90a92"],
 ", \:0433\:0434\:0435 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["A", "TI"], "1"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], ",", 
             StyleBox["j", "TI"]}], ")"}], "\[LongEqual]", 
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], "+", 
             StyleBox["j", "TI"]}], ")"}], 
         SubscriptBox[
          StyleBox["p", "TI"], 
          StyleBox["i", "TI"]], 
         SubscriptBox[
          StyleBox["p", "TI"], 
          StyleBox["j", "TI"]], 
         FractionBox["\[PartialD]", 
          RowBox[{"\[PartialD]", 
            SubscriptBox[
             StyleBox["p", "TI"], 
             RowBox[{
               StyleBox["i", "TI"], "+", 
               StyleBox["j", "TI"]}]]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "A_1(i, j) = (i + j)p_i p_j \\frac{\\partial}{\\partial p_{i + j}}", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "fad0b6b1-8e06-41b8-8229-109acc646b25"],
 " \:0438 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["A", "TI"], "2"], 
         RowBox[{"(", 
           RowBox[{
             StyleBox["i", "TI"], ",", 
             StyleBox["j", "TI"]}], ")"}], "\[LongEqual]", 
         StyleBox["i", "TI"], 
         StyleBox["j", "TI"], 
         SubscriptBox[
          StyleBox["p", "TI"], 
          RowBox[{
            StyleBox["i", "TI"], "+", 
            StyleBox["j", "TI"]}]], 
         FractionBox[
          SuperscriptBox["\[PartialD]", "2"], 
          RowBox[{"\[PartialD]", 
            SubscriptBox[
             StyleBox["p", "TI"], 
             StyleBox["i", "TI"]], "\[PartialD]", 
            SubscriptBox[
             StyleBox["p", "TI"], 
             StyleBox["j", "TI"]]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "A_2(i, j) = ijp_{i + j}\\frac{\\partial^2}{\\partial p_i \\partial \
p_j}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "b8d2ccc8-f669-465d-b5e6-ce74483c215a"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox[
          StyleBox["A", "TI"], "3"], "\[LongEqual]", 
         UnderscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["k", "TI"], "+", 
            StyleBox["l", "TI"], "\[LongEqual]", 
            StyleBox["m", "TI"], "-", "1"}], LimitsPositioning -> True], 
         FractionBox[
          RowBox[{"\[PartialD]", 
            SubscriptBox[
             StyleBox["H", "TI"], 
             StyleBox["k", "TI"]]}], 
          RowBox[{"\[PartialD]", 
            SubscriptBox[
             StyleBox["p", "TI"], 
             StyleBox["i", "TI"]]}]], 
         FractionBox[
          RowBox[{"\[PartialD]", 
            SubscriptBox[
             StyleBox["H", "TI"], 
             StyleBox["l", "TI"]]}], 
          RowBox[{"\[PartialD]", 
            SubscriptBox[
             StyleBox["p", "TI"], 
             StyleBox["j", "TI"]]}]]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "A_3=\\sum_{k+l = m-1}\\frac{\\partial H_k}{\\partial \
p_i}\\frac{\\partial H_l}{\\partial p_j}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "77606316-2400-4a37-bfef-8cbc668a9ff9"],
 ".\n\:041e\:043f\:0435\:0440\:0430\:0442\:043e\:0440 \
\:0442\:0440\:0430\:043d\:0441\:043f\:043e\:0437\:0438\:0446\:0438\:0438: ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["A", "TI"], "\[LongEqual]", 
         UnderoverscriptBox["\[Sum]", 
          RowBox[{
            StyleBox["n", "TI"], "\[LongEqual]", "1"}], "\[Infinity]", 
          LimitsPositioning -> True], 
         StyleBox["A", "TI"], 
         RowBox[{"(", 
           StyleBox["n", "TI"], ")"}]}], TraditionalForm], "errors" -> {}, 
     "input" -> "A=\\sum_{n=1}^{\\infty} A(n)", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "9cbe3fef-9e29-4f81-b559-a28f296ebd39"]
}], "Text",
 CellChangeTimes->{
  3.857024654000595*^9, {3.8576260349580183`*^9, 3.8576260431414814`*^9}, {
   3.857626640161691*^9, 3.8576266454651756`*^9}, {3.8576267095768943`*^9, 
   3.8576267283315783`*^9}},ExpressionUUID->"049d9728-6ff3-4b40-b004-\
19af870ffdb5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"hSimpleConnectedTransposition", "[", 
   RowBox[{"m_", ",", "part_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"upTo", "=", "15"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Clear", "[", "H", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"A1", "[", 
      RowBox[{"nests_", ",", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", " ", "+", " ", "j"}], ")"}], 
      RowBox[{"p", "[", "i", "]"}], 
      RowBox[{"p", "[", "j", "]"}], " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"H", "[", "nests", "]"}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"i", "+", "j"}], "]"}]}], "]"}]}]}], ";", "   ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"A2", "[", 
      RowBox[{"nests_", ",", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"i", " ", "j", " ", 
      RowBox[{"p", "[", 
       RowBox[{"i", "+", "j"}], "]"}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"H", "[", "nests", "]"}], ",", 
           RowBox[{"p", "[", "i", "]"}]}], "]"}], ",", 
         RowBox[{"p", "[", "j", "]"}]}], "]"}], "\[IndentingNewLine]", 
       ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ANonLinear", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k_", ",", "l_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"H", "[", "k", "]"}], ",", 
        RowBox[{"p", "[", "i", "]"}]}], "]"}], 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"H", "[", "l", "]"}], ",", 
        RowBox[{"p", "[", "j", "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"A3", "[", 
      RowBox[{"nests_", ",", 
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"ANonLinear", "[", 
          RowBox[{"pair", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"pair", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", "1", ",", 
               RowBox[{"nests", "-", "1", "-", "x"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"nests", "-", "2"}]}], "}"}]}], "]"}]}], "}"}]}], 
        "]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Asum", "[", 
      RowBox[{"nests_", ",", "A_", ",", "n_Integer"}], "]"}], ":=", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"nests", ",", "pair"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"pair", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"n", "-", "x"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], "}"}]}], "]"}], 
       ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"An", "[", 
      RowBox[{"n_Integer", ",", "nests_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Asum", "[", 
         RowBox[{"nests", ",", "A1", ",", "n"}], "]"}], "+", 
        RowBox[{"Asum", "[", 
         RowBox[{"nests", ",", "A2", ",", "n"}], "]"}], "+", 
        RowBox[{"Asum", "[", 
         RowBox[{"nests", ",", "A3", ",", "n"}], "]"}]}], ")"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"A", "[", "nests_", "]"}], ":=", 
     RowBox[{"Expand", "[", 
      RowBox[{"Plus", "@@", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"An", "[", 
          RowBox[{"x", ",", "nests"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "1", ",", "upTo"}], "}"}]}], "]"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"H", "[", "nests_Integer", "]"}], ":=", 
     RowBox[{
      RowBox[{"H", "[", "nests", "]"}], "=", 
      RowBox[{"A", "[", " ", 
       RowBox[{"nests", "-", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"H", "[", "0", "]"}], "=", 
     RowBox[{"Normal", "[", 
      RowBox[{"p", "[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FreeCoefficient", "[", "c_", "]"}], ":=", 
     RowBox[{"c", "/.", 
      RowBox[{
       RowBox[{"p", "[", "_", "]"}], "->", "0"}]}]}], ";", 
    RowBox[{"FreeCoefficient", "[", 
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"H", "[", "m", "]"}], ",", 
       RowBox[{"Times", "@@", 
        RowBox[{"(", 
         RowBox[{"Map", "[", 
          RowBox[{"p", ",", "part"}], "]"}], ")"}]}]}], "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"H", "[", "1", "]"}]}], "\[IndentingNewLine]", 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"hSimpleConnectedTransposition", "[", 
  RowBox[{"0", ",", 
   RowBox[{"{", "3", "}"}]}], "]"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQvcLh2bwNe944llzung+mPf0Ogmg28SMnQHTR/UXX
QPSEWV23QLT8tDn3wHSu4xsQbfH/9F8QfdpE5j+IPurlf/rq3jeOJr1OZ0D0
hddJ10F0fumNOyA6JXjFK7A8y4P3IDpLWJL7GpDecaJRGERv27HPGESfmPLQ
HETH/PLvANGHDh9dBKJZUteuAtE5k86sBtEdXYf3gWiF3P79IFpi45GHIPrY
+RWs14G0rM0yIRCd38QuCqKvOdpIg2iWP8e1QXSRsKoZiA5YvdgCROvk5dqB
aAf/GAcQ/WrWS5cnQJrv8yswDQDfOLbQ
  "],
 CellLabel->
  "In[117]:=",ExpressionUUID->"89029955-3a70-4790-8871-7dd137dfaaf0"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.85762745581137*^9, 3.8576274865337133`*^9}, {
  3.857627579829228*^9, 3.857627589383771*^9}, {3.8576276451776867`*^9, 
  3.8576276514056716`*^9}, {3.857654312173729*^9, 3.857654314888773*^9}},
 CellLabel->
  "Out[118]=",ExpressionUUID->"8df72503-e419-4815-8b9f-f4601bbf147b"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["\:0410\:0433\:043b\:0435\:0431\:0440\:0430 \:043a\:0440\:0430\:0448\
\:0435\:043d\:044b\:0445 \:043f\:0435\:0440\:0435\:0441\:0442\:0430\:043d\
\:043e\:0432\:043e\:043a", "Section",
 CellChangeTimes->{{3.8566951822410765`*^9, 
  3.8566951909010906`*^9}},ExpressionUUID->"3bccb56e-e3b4-4334-959f-\
b30bd9d233ea"],

Cell[CellGroupData[{

Cell["\:0412\:0432\:0435\:0434\:0435\:043d\:0438\:0435", "Subsubsection",
 CellChangeTimes->{{3.8577117167138605`*^9, 
  3.8577117201805687`*^9}},ExpressionUUID->"cf6a146c-bee2-4f04-848f-\
2b475b64d7f8"],

Cell["\<\
\:0412 \:044d\:0442\:043e\:043c \:0440\:0430\:0437\:0434\:0435\:043b\:0435 \
\:0440\:0435\:0430\:043b\:0438\:0437\:043e\:0432\:0430\:043d\:043e \:044d\
\:043b\:0435\:043c\:0435\:043d\:0442\:0430\:0440\:043d\:043e\:0435 \:0432\
\:044b\:0447\:0438\:0441\:043b\:0435\:043d\:0438\:0435 \:0447\:0438\:0441\
\:0435\:043b \:0413\:0443\:0440\:0432\:0438\:0446\:0430 \:0447\:0435\:0440\
\:0435\:0437 \:043a\:0440\:0430\:0448\:0435\:043d\:044b\:0435 \:043f\:0435\
\:0440\:0435\:0441\:0442\:0430\:043d\:043e\:0432\:043a\:0438. \:0412 \:0441\
\:043b\:0435\:0434\:0443\:044e\:0449\:0435\:043c \:0440\:0430\:0437\:0434\
\:0435\:043b\:0435 \:0431\:0443\:0434\:0435\:0442 \:043f\:0440\:0438\:0432\
\:0435\:0434\:0435\:043d\:043e \:0437\:043d\:0430\:0447\:0438\:0442\:0435\
\:043b\:044c\:043d\:043e \:0431\:043e\:043b\:0435\:0435 \:044d\:0444\:0444\
\:0435\:043a\:0442\:0438\:0432\:043d\:044b\:0439, \:043d\:043e \:043c\:0435\
\:043d\:0435\:0435 \:0447\:0438\:0442\:0430\:0435\:043c\:044b\:0439 \:0430\
\:043b\:0433\:043e\:0440\:0438\:0442\:043c.

\:041a\:0440\:0430\:0448\:0435\:043d\:0430\:044f \:043f\:0435\:0440\:0435\
\:0441\:0442\:0430\:043d\:043e\:0432\:043a\:0430 -- \:043f\:0430\:0440\:0430 \
\:0438\:0437 \:043f\:0435\:0440\:0435\:0441\:0442\:0430\:043d\:043e\:0432\
\:043a\:0438 \:0438 \:0440\:0430\:0441\:043a\:0440\:0430\:0441\:043a\:0438 \
\:0435\:0435 \:0438\:043d\:0432\:0430\:0440\:0438\:0430\:043d\:0442\:043d\
\:044b\:0445 \:043f\:043e\:0434\:043c\:043d\:043e\:0436\:0435\:0441\:0442\
\:0432.  \:0411\:0443\:0434\:0435\:043c \:043e\:0431\:043e\:0437\:043d\:0430\
\:0447\:0430\:0442\:044c \:0437\:0430 ColoredCycles.\
\>", "Text",
 CellChangeTimes->{{3.8566952020513086`*^9, 3.85669523023728*^9}, {
   3.8566953540942388`*^9, 3.8566953666630955`*^9}, 3.8566954638111057`*^9, {
   3.8566962216580563`*^9, 3.8566962417102203`*^9}, {3.8577117010775337`*^9, 
   3.8577118116576915`*^9}},ExpressionUUID->"f9932d07-be1c-43e9-864e-\
a325b1d28c0a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ColoredCycles", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Cycles", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", "3", "}"}]}], "}"}], "]"}], ",", " ", 
   RowBox[{"(*", " ", "Permutation", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}]}], " ", 
  RowBox[{"(*", " ", "Coloring", " ", "*)"}], "\[IndentingNewLine]", " ", 
  "]"}]], "Input",
 CellChangeTimes->{{3.856695191982485*^9, 3.8566951930580177`*^9}, {
  3.8566962437939496`*^9, 3.8566962969112825`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"90feebeb-1374-49b7-b493-5ef954fbba08"],

Cell[BoxData[
 RowBox[{"ColoredCycles", "[", 
  RowBox[{
   RowBox[{"Cycles", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "1", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.857625838238865*^9, 3.857714252355785*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"54898af5-cea5-4be1-b1a5-eb062412d50a"]
}, Open  ]],

Cell["\<\
\:0424\:0443\:043d\:043a\:0446\:0438\:044f CommonSubpartition \:0438\:0449\
\:0435\:0442 \:043c\:0438\:043d\:0438\:043c\:0430\:043b\:044c\:043d\:043e\
\:0435 \:0440\:0430\:0437\:0431\:0438\:0435\:043d\:0438\:0435, \:043a\:043e\
\:0442\:043e\:0440\:043e\:043c\:0443 \:043f\:043e\:0434\:0447\:0438\:043d\
\:0435\:043d\:044b \:0430\:0440\:0433\:0443\:043c\:0435\:043d\:0442\:044b. 

\:0424\:0443\:043d\:043a\:0446\:0438\:044f ColoredCyclesProduct \:0441\:0447\
\:0438\:0442\:0430\:0435\:0442 \:043f\:0440\:043e\:0438\:0437\:0432\:0435\
\:0434\:0435\:043d\:0438\:0435 \:043a\:0440\:0430\:0448\:0435\:043d\:044b\
\:0445 \:043f\:0435\:0440\:0435\:0441\:0442\:0430\:043d\:043e\:0432\:043e\
\:043a. \:041f\:0440\:043e\:0438\:0437\:0432\:0435\:0434\:0435\:043d\:0438\
\:0435 \:043a\:0440\:0430\:0448\:0435\:043d\:044b\:0445 \:043f\:0435\:0440\
\:0435\:0441\:0442\:0430\:043d\:043e\:0432\:043e\:043a \:0441\:043e\:0441\
\:0442\:043e\:0438\:0442 \:0438\:0437 \:043f\:0430\:0440\:044b \
(PermutationProduct, CommonSubpartition).

\:0424\:0443\:043d\:043a\:0446\:0438\:044f MakeColoredPerm \:0441\:0442\:0440\
\:043e\:0438\:0442 \:043f\:043e \:043f\:0440\:0435\:0434\:0441\:0442\:0430\
\:0432\:043b\:0435\:043d\:0438\:044e \:043f\:0435\:0440\:0435\:0441\:0442\
\:0430\:043d\:043e\:0432\:043a\:0438 \:0432 \:0432\:0438\:0434\:0435 \:0441\
\:043f\:0438\:0441\:043a\:0430 \:043a\:0440\:0430\:0448\:0435\:043d\:0443\
\:044e \:043f\:0435\:0440\:0435\:0441\:0442\:0430\:043d\:043e\:0432\:043a\
\:0443, \:0443 \:043a\:043e\:0442\:043e\:0440\:043e\:0439 \:0432\:0441\:0435 \
\:0446\:0438\:043a\:043b\:044b \:043e\:043a\:0440\:0430\:0448\:0435\:043d\
\:044b \:0432 \:0440\:0430\:0437\:043d\:044b\:0435 \:0446\:0432\:0435\:0442\
\:0430.\
\>", "Text",
 CellChangeTimes->{{3.8577093551982727`*^9, 3.857709513642184*^9}, {
  3.8577118205839014`*^9, 
  3.857711860320719*^9}},ExpressionUUID->"342abed7-fb11-433c-863b-\
c015784ceefb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CommonSubpartition", "[", 
    RowBox[{"part1_", ",", " ", "part2_"}], "]"}], ":=", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"slow", " ", "but", " ", "readable"}], " ", "*)"}], " ", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Union", "[", "part1", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"part", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"part1", ",", "part2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"CleanPart", "[", 
       RowBox[{"part_", ",", "k_"}], "]"}], ":=", 
      RowBox[{"(", " ", 
       RowBox[{"(*", " ", 
        RowBox[{
        "unite", " ", "evetything", " ", "that", " ", "has", " ", "i"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"united", "=", 
         RowBox[{"Union", "@@", 
          RowBox[{"Select", "[", 
           RowBox[{"part", ",", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"#", ",", "k"}], "]"}], "&"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"res", "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"part", ",", 
             RowBox[{
              RowBox[{"Not", "[", 
               RowBox[{"MemberQ", "[", 
                RowBox[{"#", ",", "k"}], "]"}], "]"}], "&"}]}], "]"}], ",", 
           "united"}], "]"}]}], ";", "\[IndentingNewLine]", "res"}], 
       "\[IndentingNewLine]", ")"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "<=", "n"}], ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{
        RowBox[{"part", "=", 
         RowBox[{"CleanPart", "[", 
          RowBox[{"part", ",", "i"}], "]"}]}], ";"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "part"}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Clear", "[", "ColoredCyclesProduct", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColoredCyclesProduct", "[", 
   RowBox[{"cycles1_", ",", " ", "cycles2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"ColoredCyclesProduct", "[", 
    RowBox[{"cycles1", ",", "cycles2"}], "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"ColoredCycles", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PermutationProduct", "[", 
      RowBox[{
       RowBox[{"cycles1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"cycles2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"CommonSubpartition", "[", 
      RowBox[{
       RowBox[{"cycles1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"cycles2", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColoredCyclesProduct", "[", "list_", "]"}], ":=", 
   RowBox[{"Fold", "[", 
    RowBox[{"ColoredCyclesProduct", ",", "list"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakeColoredPerm", "[", "permList_", "]"}], ":=", 
  RowBox[{"ColoredCycles", "[", 
   RowBox[{
    RowBox[{"PermutationCycles", "[", "permList", "]"}], ",", 
    RowBox[{"PermutationCycles", "[", 
     RowBox[{"permList", ",", "Identity"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.856695468812337*^9, 3.856695632778352*^9}, {
   3.8566957517015047`*^9, 3.856695767143338*^9}, {3.8566958001808367`*^9, 
   3.85669580793088*^9}, {3.856695859469679*^9, 3.856695948128516*^9}, {
   3.8566959806154957`*^9, 3.8566959878978643`*^9}, {3.856696044413084*^9, 
   3.8566960450768394`*^9}, {3.8566961388071427`*^9, 3.856696189201391*^9}, {
   3.8566963000343423`*^9, 3.856696333002101*^9}, {3.856696445259379*^9, 
   3.8566964487371373`*^9}, {3.8566966971528225`*^9, 
   3.8566967556056733`*^9}, {3.8569360984018035`*^9, 3.856936265893444*^9}, {
   3.8569363016010103`*^9, 3.8569364114920654`*^9}, {3.856936566768317*^9, 
   3.8569366147632966`*^9}, {3.8569367351540203`*^9, 
   3.8569368475839186`*^9}, {3.856936915036792*^9, 3.8569371015348024`*^9}, {
   3.8569371434986243`*^9, 3.856937182520872*^9}, {3.8569373059739137`*^9, 
   3.8569374262273498`*^9}, {3.8569374856949806`*^9, 
   3.8569375916206636`*^9}, {3.856937661419427*^9, 3.856937662728243*^9}, {
   3.8569382101039686`*^9, 3.856938433138101*^9}, {3.8569385229196978`*^9, 
   3.856938549002795*^9}, {3.8569385913516946`*^9, 3.8569389141393595`*^9}, {
   3.8569389921178827`*^9, 3.8569391018401575`*^9}, {3.856939258534315*^9, 
   3.856939281073989*^9}, {3.856939417291952*^9, 3.856939426902457*^9}, {
   3.8576546017872567`*^9, 3.8576546312869234`*^9}, 3.8576561172971787`*^9, {
   3.8576574802955694`*^9, 3.8576575002366734`*^9}, {3.8577094037731156`*^9, 
   3.857709404780277*^9}, {3.857711572156133*^9, 3.85771159815898*^9}, 
   3.857714291747568*^9},ExpressionUUID->"3baf7a63-9ae5-4afc-af27-\
4ebc770828f9"],

Cell["\:0420\:0430\:0437\:043d\:044b\:0435 \:043f\:0440\:043e\:0432\:0435\
\:0440\:043a\:0438 \:0446\:0438\:043a\:043b\:0438\:0447\:0435\:0441\:043a\
\:0438\:0445 \:0442\:0438\:043f\:043e\:0432", "Text",
 CellChangeTimes->{{3.8577095364447823`*^9, 
  3.857709545076195*^9}},ExpressionUUID->"12aebd9a-1abe-4e38-a361-\
bf7ac5a5cbf3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"IsSameCycleType", "[", 
   RowBox[{"perm1_", ",", "perm2_"}], "]"}], ":=", 
  RowBox[{"Equal", "[", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Tally", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", 
        RowBox[{"perm1", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"Sort", "[", 
     RowBox[{"Tally", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", 
        RowBox[{"perm2", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HasCycleType", "[", 
   RowBox[{"perm_", ",", "part_"}], "]"}], ":=", 
  RowBox[{"Equal", "[", 
   RowBox[{
    RowBox[{"Sort", "[", 
     RowBox[{"Tally", "[", 
      RowBox[{"Map", "[", 
       RowBox[{"Length", ",", 
        RowBox[{"perm", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}], ",", 
    RowBox[{"Sort", "[", 
     RowBox[{"Tally", "[", 
      RowBox[{"Select", "[", 
       RowBox[{"part", ",", 
        RowBox[{
         RowBox[{"#", "!=", "1"}], "&"}]}], "]"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColoredHasCycleType", "[", 
   RowBox[{"colPerm_", ",", "part_"}], "]"}], ":=", 
  RowBox[{"HasCycleType", "[", 
   RowBox[{
    RowBox[{"colPerm", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "part"}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.857629313306755*^9, 3.8576294771087027`*^9}, {
   3.8576548144627037`*^9, 3.8576548774698424`*^9}, {3.857654918966097*^9, 
   3.8576549375969286`*^9}, 3.857655149670066*^9, {3.8576552440456448`*^9, 
   3.857655244263111*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"49e84592-4d1b-4348-900c-9c625f185c40"],

Cell[TextData[{
 "\:0424\:0443\:043d\:043a\:0446\:0438\:044f ColoredPermBasisElement \:043f\
\:043e \:0440\:0430\:0437\:0431\:0438\:0435\:043d\:0438\:044e \:0441\:043f\
\:0438\:0441\:043e\:043a \:043a\:0440\:0430\:0448\:0435\:043d\:044b\:0445 \
\:043f\:0435\:0440\:0435\:0441\:0442\:0430\:043d\:043e\:0432\:043e\:043a, \
\:0443 \:043a\:043e\:0442\:043e\:0440\:044b\:0445 \:0446\:0438\:043a\:043b\
\:043e\:0442\:0438\:043f --- \:0440\:0430\:0437\:0431\:0438\:0435\:043d\:0438\
\:0435 \:0438 \:0432\:0441\:0435 \:0446\:0438\:043a\:043b\:044b \:043e\:043a\
\:0440\:0430\:0448\:0435\:043d\:044b \:0432 \:0440\:0430\:0437\:043d\:044b\
\:0435 \:0446\:0432\:0435\:0442\:0430. \:0414\:043b\:044f \:0447\:0438\:0441\
\:0435\:043b \:0413\:0443\:0440\:0432\:0438\:0446\:0430 \:044d\:0442\:043e \
\:0438 \:043d\:0430\:0434\:043e.\n\n\:0424\:0443\:043d\:0446\:0438\:044f \
Colored Basis Product \:0441\:0442\:0440\:043e\:0438\:0442 \:043f\:0440\:043e\
\:0438\:0437\:0432\:0435\:0434\:0435\:043d\:0438\:0435 ColoredBasisElement \
\:0441 \:0437\:0430\:0434\:0430\:043d\:043d\:044b\:043c\:0438 \:0446\:0438\
\:043a\:043b\:043e\:0442\:0438\:043f\:0430\:043c\:0438.\n\n\:0424\:0443\:043d\
\:043a\:0446\:0438\:044f ColoredPermIsId \:043e\:0441\:0443\:0449\:0435\:0441\
\:0442\:0432\:043b\:044f\:0435\:0442 \:043f\:0440\:043e\:0432\:0435\:0440\
\:043a\:0443 \:0442\:043e\:0433\:043e, \:0447\:0442\:043e \:0434\:0430\:043d\
\:043d\:0430\:044f \:043a\:0440\:0430\:0448\:0435\:043d\:0430\:044f \:043f\
\:0435\:0440\:0435\:0441\:0442\:0430\:043d\:043e\:0432\:043a\:0430 \:044f\
\:0432\:043b\:044f\:0435\:0442\:0441\:044f \:0442\:043e\:0436\:0434\:0435\
\:0441\:0442\:0432\:0435\:043d\:043d\:043e\:0439 \:0441\:043e \:0432\:0441\
\:0435\:043c\:0438 \:0446\:0438\:043a\:043b\:0430\:043c\:0438 \:0440\:0430\
\:0437\:043d\:043e\:0433\:043e \:0446\:0432\:0435\:0442\:0430. \n\n\:0427\
\:0438\:0441\:043b\:043e \:0442\:0430\:043a\:0438\:0445 \:043f\:0435\:0440\
\:0435\:0441\:0442\:0430\:043d\:043e\:0432\:043e\:043a \:0432 \
ColoredBasisProduct[",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubscriptBox["\[Beta]", "1"], ",", "\[Ellipsis]", ",", 
         SubscriptBox["\[Beta]", 
          StyleBox["c", "TI"]]}], TraditionalForm], "errors" -> {}, "input" -> 
     "\\beta_1,\\ldots,\\beta_c", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "ff54d979-39e6-4819-9e06-8ea86405c6e9"],
 "], \:0434\:0435\:043b\:0435\:043d\:043d\:043e\:0435 \:043d\:0430 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["n", "TI"], "!"}], TraditionalForm], "errors" -> {}, 
     "input" -> "n!", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "de688572-fecb-4a21-a61d-672e3954b81f"],
 " \:0434\:0430\:0435\:0442 \:0447\:0438\:0441\:043b\:043e \:0413\:0443\:0440\
\:0432\:0438\:0446\:0430 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["h", "TI"], 
        RowBox[{
          SubscriptBox["\[Beta]", "1"], ",", "\[Ellipsis]", ",", 
          SubscriptBox["\[Beta]", 
           StyleBox["l", "TI"]], ",", 
          StyleBox["n", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "h_{\\beta_1,\\ldots,\\beta_l,n}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c8e40c50-4eb1-4652-a568-39124b9affab"],
 "."
}], "Text",
 CellChangeTimes->{{3.8577095568830023`*^9, 3.857709652111988*^9}, {
  3.8577097215775323`*^9, 3.857709735975792*^9}, {3.85771430443482*^9, 
  3.8577143225418196`*^9}},ExpressionUUID->"58383deb-f847-4072-a4ea-\
f76f140fcb39"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ColoredPermBasisElement", "[", "part_", "]"}], ":=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"MakeColoredPerm", "/@", 
      RowBox[{"Permutations", "[", 
       RowBox[{"Range", "[", 
        RowBox[{"Plus", "@@", "part"}], "]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"ColoredHasCycleType", "[", 
       RowBox[{"#", ",", "part"}], "]"}], "&"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ColoredBasisProduct", "[", "partList_", "]"}], ":=", 
   RowBox[{"ColoredCyclesProduct", "/@", 
    RowBox[{"Tuples", "[", 
     RowBox[{"ColoredPermBasisElement", "/@", "partList"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ColoredPermIsId", "[", 
   RowBox[{"colPerm_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"And", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"colPerm", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "==", 
     RowBox[{"Cycles", "[", 
      RowBox[{"{", "}"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"colPerm", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "==", 
     RowBox[{"List", "[", 
      RowBox[{"Range", "[", "n", "]"}], "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8576553847490034`*^9, 3.857655443281749*^9}, {
  3.8577142715520945`*^9, 3.857714282110091*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"898cfb4e-d4bc-49db-a967-5ea93acfdb3e"],

Cell[TextData[{
 "\:0427\:0438\:0441\:043b\:043e \:0413\:0443\:0440\:0432\:0438\:0446\:0430 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["h", "TI"], 
        RowBox[{"3", ",", "2", ",", "2"}]], TraditionalForm], "errors" -> {}, 
     "input" -> "h_{3,2,2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4bacc51e-ebb6-47bb-bb4c-427d986c4f0c"],
 "."
}], "Text",
 CellChangeTimes->{{3.8577105581619596`*^9, 3.8577106117461414`*^9}, {
  3.85771432774584*^9, 
  3.857714328357792*^9}},ExpressionUUID->"750687b7-175f-46e6-9f99-\
a07d9e514bd1"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"Select", "[", 
   RowBox[{
    RowBox[{"ColoredBasisProduct", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", "3", "}"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"ColoredPermIsId", "[", 
      RowBox[{"#", ",", "3"}], "]"}], "&"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8576594542823963`*^9, 3.8576595222666683`*^9}, {
  3.8576598580584373`*^9, 3.8576598619686103`*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"d053e1a2-360d-4954-81e5-832cea542cfc"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.857659479382948*^9, 3.8576595229583325`*^9}, {
   3.8576598625065017`*^9, 3.8576598683706675`*^9}, 3.8577105409252157`*^9, 
   3.8577106127111254`*^9, 3.857713481079731*^9, 3.857714333691774*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"07f80b22-39db-4996-98aa-db4d432f0bf0"]
}, Open  ]],

Cell[TextData[{
 "\:0424\:0443\:043d\:043a\:0446\:0438\:044f PartStabilize \:0434\:043e\:0431\
\:0430\:0432\:043b\:044f\:0435\:0442 \:0440\:0430\:0437\:0431\:0438\:0435\
\:043d\:0438\:044e \:0441\:0442\:043e\:043b\:044c\:043a\:043e \:0441\:0438\
\:043d\:0433\:043b\:0442\:043e\:043d\:043e\:0432, \:0441\:043a\:043e\:043b\
\:044c\:043a\:043e \:043d\:0443\:0436\:043d\:043e \:0434\:043b\:044f \:0437\
\:0430\:0434\:0430\:043d\:0438\:044f \:043f\:0435\:0440\:0435\:0441\:0442\
\:0430\:043d\:043e\:0432\:043a\:0438 \:0432 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["S", "TI"], 
        StyleBox["n", "TI"]], TraditionalForm], "errors" -> {}, "input" -> 
     "S_n", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "466c7196-c6dd-428d-a384-b0da961a7b5a"],
 "."
}], "Text",
 CellChangeTimes->{{3.8577136071323757`*^9, 3.8577136585507727`*^9}, {
  3.857713812196039*^9, 3.857713852110793*^9}, {3.8577143350868316`*^9, 
  3.8577143423473473`*^9}},ExpressionUUID->"e9e986ce-a711-4ba1-9f5c-\
07f26423465d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PartStabilize", "[", 
   RowBox[{"part_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"i", "<=", 
       RowBox[{"Length", "[", "part", "]"}]}], ",", 
      RowBox[{"part", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"n", "-", 
       RowBox[{"Plus", "@@", "part"}], "+", 
       RowBox[{"Length", "[", "part", "]"}]}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8577136680348773`*^9, 3.8577137136945543`*^9}, {
  3.8577137476230903`*^9, 3.8577138061997766`*^9}, {3.8577138720047836`*^9, 
  3.8577138905747805`*^9}, {3.857713928435831*^9, 3.857713960018773*^9}, {
  3.857714027969656*^9, 3.857714032199581*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"a0d1e8a1-f70c-46c6-a5f5-f94196b2dddd"],

Cell[TextData[{
 "\:0424\:0443\:043d\:043a\:0446\:0438\:044f hGeneral \
\:0432\:044b\:0447\:0438\:0441\:043b\:044f\:0435\:0442 \:0447\:0438\:0441\
\:043b\:043e \:0413\:0443\:0440\:0432\:0438\:0446\:0430 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       SubscriptBox[
        StyleBox["h", "TI"], 
        RowBox[{
          SubscriptBox["\[Beta]", "1"], ",", "\[Ellipsis]", ",", 
          SubscriptBox["\[Beta]", 
           StyleBox["l", "TI"]], ",", 
          StyleBox["n", "TI"]}]], TraditionalForm], "errors" -> {}, "input" -> 
     "h_{\\beta_1,\\ldots,\\beta_l,n}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "7c4d8a36-0be8-4b02-a500-0a17556a9af2"],
 "."
}], "Text",
 CellChangeTimes->{{3.857710936097535*^9, 3.857710941297711*^9}, {
  3.857711272769796*^9, 
  3.8577113206997657`*^9}},ExpressionUUID->"cdf63015-ca4c-488c-a576-\
34a1bcc58578"],

Cell[BoxData[
 RowBox[{
  RowBox[{"hGeneral", "[", 
   RowBox[{"partList_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"partListStabilized", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"PartStabilize", "[", 
         RowBox[{"#", ",", "n"}], "]"}], "&"}], ")"}], "/@", "partList"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"ColoredBasisProduct", "[", "partListStabilized", "]"}], ",", 
        RowBox[{
         RowBox[{"ColoredPermIsId", "[", 
          RowBox[{"#", ",", "n"}], "]"}], "&"}]}], "]"}], "]"}], "/", 
     RowBox[{"n", "!"}]}]}], "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.857659605132923*^9, 3.857659616992544*^9}, {
  3.8577106806977673`*^9, 3.857710765258768*^9}, {3.8577141047295275`*^9, 
  3.8577141610115294`*^9}, {3.8577142245718393`*^9, 3.857714238542347*^9}, {
  3.8577143730957747`*^9, 3.857714393186594*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"d61c9cb9-ba9a-40b4-955c-7328e6af10bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:041f\:0440\:0438\:043c\:0435\:0440\:044b \:0432\:044b\:0447\:0438\
\:0441\:043b\:0435\:043d\:0438\:044f \:0427\:0438\:0441\:0435\:043b \:0413\
\:0443\:0440\:0432\:0438\:0446\:0430", "Subsection",
 CellChangeTimes->{{3.857711346255584*^9, 
  3.8577113557774925`*^9}},ExpressionUUID->"38aaba73-eb68-4fb2-9c80-\
9d0f93ee551e"],

Cell[TextData[{
 "\:0420\:0430\:0437\:0431\:0438\:0435\:043d\:0438\:0435 \:0442\:0440\:0430\
\:043d\:0441\:043f\:043e\:0437\:0438\:0446\:0438\:0438 \:0432 \:0442\:0440\
\:0438 \:0442\:0440\:0430\:043d\:0441\:043f\:043e\:0437\:0438\:0446\:0438\
\:0438 \:0434\:043b\:044f ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    TemplateBox[<|"boxes" -> FormBox[
        RowBox[{
          StyleBox["n", "TI"], "\[LongEqual]", "3"}], TraditionalForm], 
      "errors" -> {}, "input" -> "n=3", "state" -> "Boxes"|>,
     "TeXAssistantTemplate"], ":"}], TraditionalForm]],ExpressionUUID->
  "22d847bb-c73f-4f62-8fb0-3220efdf6a9e"]
}], "Text",
 CellChangeTimes->{{3.857711369347911*^9, 
  3.8577114511585007`*^9}},ExpressionUUID->"83f21464-cd71-49a1-9186-\
c80d37d53fa8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hGeneral", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}], ",", "3"}], "]"}]], "Input",
 CellChangeTimes->{{3.8577107417086906`*^9, 3.8577107898005314`*^9}, {
  3.8577109135265255`*^9, 3.8577109204484835`*^9}, {3.8577114294065485`*^9, 
  3.857711430256423*^9}, {3.857714394908167*^9, 3.8577143999117575`*^9}, {
  3.857714440720951*^9, 3.8577144683437796`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"f7023fe6-aad2-46e1-8e6d-be661487d773"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{{3.857710755092533*^9, 3.8577107902805634`*^9}, 
   3.857710920660774*^9, 3.857711430683426*^9, 3.857713485748779*^9, {
   3.8577141637171836`*^9, 3.8577141652726893`*^9}, {3.857714232830531*^9, 
   3.857714245835823*^9}, {3.8577143518888245`*^9, 3.8577144004227347`*^9}, {
   3.857714441130223*^9, 3.8577144686507144`*^9}},
 CellLabel->"Out[80]=",ExpressionUUID->"b01943f5-2dc4-4ec2-8588-80aa969e82c3"]
}, Open  ]],

Cell[TextData[{
 "\:0420\:0430\:0437\:0431\:0438\:0435\:043d\:0438\:0435 \:0446\:0438\:043a\
\:043b\:0430 \:0434\:043b\:0438\:043d\:044b ",
 Cell[BoxData[
  FormBox[
   RowBox[{"4", " "}], TraditionalForm]],ExpressionUUID->
  "5186d44b-bd53-45b5-b9a0-af0c6e2fb5e1"],
 "\:0432 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["3", TraditionalForm], "errors" -> {}, "input" -> "3", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2d1f860b-e2b4-4dc5-95d3-bf41d657b739"],
 " \:0442\:0440\:0430\:043d\:0441\:043f\:043e\:0437\:0438\:0446\:0438\:0438:"
}], "Text",
 CellChangeTimes->{{3.857711463568779*^9, 
  3.8577115098205543`*^9}},ExpressionUUID->"d872c41f-8c02-4d84-a657-\
6eed500aaa5d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hGeneral", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "4", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}], ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.857711516006256*^9, 3.857711556821947*^9}, {
  3.857714403328535*^9, 3.8577144095275297`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"ca04b450-9c04-4fcd-bace-d14f49d29ea2"],

Cell[BoxData["4"], "Output",
 CellChangeTimes->{{3.8577115358890944`*^9, 3.8577115575526824`*^9}, 
   3.8577116028204584`*^9, 3.857713487437809*^9, {3.8577143547665234`*^9, 
   3.857714409986493*^9}, 3.8577144855177116`*^9},
 CellLabel->"Out[81]=",ExpressionUUID->"af7d4ef8-5e67-4d87-9b1a-cd7f4feb126b"]
}, Open  ]],

Cell[TextData[{
 "\:0420\:0430\:0437\:0431\:0438\:0435\:043d\:0438\:0435 \:0446\:0438\:043a\
\:043b\:0430 \:0434\:043b\:0438\:043d\:044b ",
 Cell[BoxData[
  FormBox[
   RowBox[{"5", " "}], TraditionalForm]],ExpressionUUID->
  "d18bedf6-88a8-4fd6-b0d1-f2c1a73dd3b3"],
 "\:0432 ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|
    "boxes" -> FormBox["4", TraditionalForm], "errors" -> {}, "input" -> "4", 
     "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "88effca6-d9c3-48a1-9cc2-9e4596a68a1b"],
 " \:0442\:0440\:0430\:043d\:0441\:043f\:043e\:0437\:0438\:0446\:0438\:0438:"
}], "Text",
 CellChangeTimes->{{3.8577116183850517`*^9, 
  3.857711627035167*^9}},ExpressionUUID->"4c167010-6263-4a62-a8ac-\
b07450204f70"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hGeneral", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "2", "}"}], ",", 
     RowBox[{"{", "2", "}"}]}], "}"}], ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.857711607794916*^9, 3.857711658121963*^9}, {
  3.8577144115018177`*^9, 3.857714419145978*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"9121b4c8-9ac2-438c-b709-04d1a56cd441"],

Cell[BoxData["25"], "Output",
 CellChangeTimes->{{3.857711652702135*^9, 3.857711663581832*^9}, {
   3.857713491839546*^9, 3.8577134960904055`*^9}, 3.8577143886639833`*^9, 
   3.8577144217885942`*^9, 3.8577144905307617`*^9},
 CellLabel->"Out[82]=",ExpressionUUID->"d00cf938-03c2-4d4b-9817-2241f3177c1f"]
}, Open  ]],

Cell["\:0420\:0430\:0437\:0431\:0438\:0435\:043d\:0438\:0435 \:0446\:0438\
\:043a\:043b\:0430 \:0434\:043b\:0438\:043d\:044b 5 \:0432 \:0434\:0432\:0430 \
\:0446\:0438\:043a\:043b\:0430 \:0434\:043b\:0438\:043d\:044b 3:", "Text",
 CellChangeTimes->{{3.8577119092317944`*^9, 3.8577119356215925`*^9}, {
  3.8577144919365354`*^9, 
  3.857714492760773*^9}},ExpressionUUID->"4138f38a-72b2-4002-80b3-\
44075755a2ee"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hGeneral", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "5", "}"}], ",", 
     RowBox[{"{", "3", "}"}], ",", 
     RowBox[{"{", "3", "}"}]}], "}"}], ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.8577119369534283`*^9, 3.8577119769004874`*^9}, {
  3.8577144965159903`*^9, 3.85771450061269*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"e8c6a5f3-e02c-4c5a-bb25-7b8d8172fbff"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.8577119775410247`*^9, 3.8577134980186024`*^9, {3.8577144939246807`*^9, 
   3.8577145010936794`*^9}},
 CellLabel->"Out[84]=",ExpressionUUID->"7a57b569-812a-48b8-8ee8-8b8357b0efa1"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.857711932023537*^9, 
  3.8577119331457787`*^9}},ExpressionUUID->"2b7f07ea-ba69-457b-bb83-\
dd66902e5e7d"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8577119039757805`*^9, 
  3.8577119039787807`*^9}},ExpressionUUID->"78f465ac-a16d-40ab-aaea-\
91c9f4f29590"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{718.5, 729.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1. Inherited,
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"cd2065a7-7f36-4290-b448-010d1ea25d1e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 416, 6, 105, "Section",ExpressionUUID->"9dc9926a-e6d7-4447-9419-42ffdee9be8e"],
Cell[999, 30, 1782, 42, 119, "Text",ExpressionUUID->"8c5959f8-1fd2-4514-b9d4-7a125a0260e5"],
Cell[2784, 74, 2874, 77, 261, "Input",ExpressionUUID->"7680901e-88af-40dd-9776-8240f9816857"]
}, Closed]],
Cell[CellGroupData[{
Cell[5695, 156, 404, 6, 53, "Section",ExpressionUUID->"6727e29a-26e0-4a75-b256-fa682a075242"],
Cell[6102, 164, 1816, 47, 207, "Input",ExpressionUUID->"e57ec284-b2d9-4ac4-aaa0-8d024b0f6ac0"]
}, Closed]],
Cell[CellGroupData[{
Cell[7955, 216, 309, 5, 53, "Section",ExpressionUUID->"e93786fc-0543-4e1b-beee-d044fc1204f1"],
Cell[8267, 223, 4332, 119, 111, "Text",ExpressionUUID->"24a36f4d-8076-46db-a902-a411b8ebebfa"],
Cell[CellGroupData[{
Cell[12624, 346, 345, 5, 54, "Subsection",ExpressionUUID->"707b6586-042b-451b-99f2-ce36fad10d27"],
Cell[12972, 353, 5979, 143, 477, "Input",ExpressionUUID->"b32d5504-6d81-4e05-9dd6-642b48f7c72a"]
}, Closed]],
Cell[CellGroupData[{
Cell[18988, 501, 394, 6, 38, "Subsection",ExpressionUUID->"26379ea7-1e84-4a72-a507-0326df8f1866"],
Cell[19385, 509, 5731, 157, 158, "Text",ExpressionUUID->"049d9728-6ff3-4b40-b004-19af870ffdb5"],
Cell[CellGroupData[{
Cell[25141, 670, 5907, 164, 694, "Input",ExpressionUUID->"89029955-3a70-4790-8871-7dd137dfaaf0"],
Cell[31051, 836, 326, 5, 32, "Output",ExpressionUUID->"8df72503-e419-4815-8b9f-f4601bbf147b"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[31438, 848, 317, 5, 53, "Section",ExpressionUUID->"3bccb56e-e3b4-4334-959f-b30bd9d233ea"],
Cell[CellGroupData[{
Cell[31780, 857, 203, 3, 45, "Subsubsection",ExpressionUUID->"cf6a146c-bee2-4f04-848f-2b475b64d7f8"],
Cell[31986, 862, 1951, 29, 150, "Text",ExpressionUUID->"f9932d07-be1c-43e9-864e-a325b1d28c0a"],
Cell[CellGroupData[{
Cell[33962, 895, 778, 19, 102, "Input",ExpressionUUID->"90feebeb-1374-49b7-b493-5ef954fbba08"],
Cell[34743, 916, 482, 13, 32, "Output",ExpressionUUID->"54898af5-cea5-4be1-b1a5-eb062412d50a"]
}, Open  ]],
Cell[35240, 932, 1916, 31, 219, "Text",ExpressionUUID->"342abed7-fb11-433c-863b-c015784ceefb"],
Cell[37159, 965, 5070, 112, 592, "Input",ExpressionUUID->"3baf7a63-9ae5-4afc-af27-4ebc770828f9"],
Cell[42232, 1079, 331, 5, 35, "Text",ExpressionUUID->"12aebd9a-1abe-4e38-a361-bf7ac5a5cbf3"],
Cell[42566, 1086, 1783, 49, 156, "Input",ExpressionUUID->"49e84592-4d1b-4348-900c-9c625f185c40"],
Cell[44352, 1137, 3681, 67, 293, "Text",ExpressionUUID->"58383deb-f847-4072-a4ea-f76f140fcb39"],
Cell[48036, 1206, 1429, 38, 228, "Input",ExpressionUUID->"898cfb4e-d4bc-49db-a967-5ea93acfdb3e"],
Cell[49468, 1246, 640, 16, 37, "Text",ExpressionUUID->"750687b7-175f-46e6-9f99-a07d9e514bd1"],
Cell[CellGroupData[{
Cell[50133, 1266, 663, 17, 43, "Input",ExpressionUUID->"d053e1a2-360d-4954-81e5-832cea542cfc"],
Cell[50799, 1285, 325, 4, 32, "Output",ExpressionUUID->"07f80b22-39db-4996-98aa-db4d432f0bf0"]
}, Open  ]],
Cell[51139, 1292, 1097, 22, 60, "Text",ExpressionUUID->"e9e986ce-a711-4ba1-9f5c-07f26423465d"],
Cell[52239, 1316, 898, 21, 62, "Input",ExpressionUUID->"a0d1e8a1-f70c-46c6-a5f5-f94196b2dddd"],
Cell[53140, 1339, 919, 22, 38, "Text",ExpressionUUID->"cdf63015-ca4c-488c-a576-34a1bcc58578"],
Cell[54062, 1363, 1109, 26, 121, "Input",ExpressionUUID->"d61c9cb9-ba9a-40b4-955c-7328e6af10bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55208, 1394, 331, 5, 54, "Subsection",ExpressionUUID->"38aaba73-eb68-4fb2-9c80-9d0f93ee551e"],
Cell[55542, 1401, 754, 17, 37, "Text",ExpressionUUID->"83f21464-cd71-49a1-9186-c80d37d53fa8"],
Cell[CellGroupData[{
Cell[56321, 1422, 609, 13, 28, "Input",ExpressionUUID->"f7023fe6-aad2-46e1-8e6d-be661487d773"],
Cell[56933, 1437, 451, 6, 32, "Output",ExpressionUUID->"b01943f5-2dc4-4ec2-8588-80aa969e82c3"]
}, Open  ]],
Cell[57399, 1446, 753, 19, 37, "Text",ExpressionUUID->"d872c41f-8c02-4d84-a657-6eed500aaa5d"],
Cell[CellGroupData[{
Cell[58177, 1469, 453, 11, 28, "Input",ExpressionUUID->"ca04b450-9c04-4fcd-bace-d14f49d29ea2"],
Cell[58633, 1482, 303, 4, 32, "Output",ExpressionUUID->"af7d4ef8-5e67-4d87-9b1a-cd7f4feb126b"]
}, Open  ]],
Cell[58951, 1489, 753, 19, 37, "Text",ExpressionUUID->"4c167010-6263-4a62-a8ac-b07450204f70"],
Cell[CellGroupData[{
Cell[59729, 1512, 489, 12, 28, "Input",ExpressionUUID->"9121b4c8-9ac2-438c-b709-04d1a56cd441"],
Cell[60221, 1526, 302, 4, 32, "Output",ExpressionUUID->"d00cf938-03c2-4d4b-9817-2241f3177c1f"]
}, Open  ]],
Cell[60538, 1533, 410, 6, 35, "Text",ExpressionUUID->"4138f38a-72b2-4002-80b3-44075755a2ee"],
Cell[CellGroupData[{
Cell[60973, 1543, 420, 10, 28, "Input",ExpressionUUID->"e8c6a5f3-e02c-4c5a-bb25-7b8d8172fbff"],
Cell[61396, 1555, 232, 4, 32, "Output",ExpressionUUID->"7a57b569-812a-48b8-8ee8-8b8357b0efa1"]
}, Open  ]],
Cell[61643, 1562, 154, 3, 28, "Input",ExpressionUUID->"2b7f07ea-ba69-457b-bb83-dd66902e5e7d"],
Cell[61800, 1567, 156, 3, 28, "Input",ExpressionUUID->"78f465ac-a16d-40ab-aaea-91c9f4f29590"]
}, Open  ]]
}, Open  ]]
}
]
*)

